(function(e){var t=function(t,n,r){this.target=t,this.isMarkdown=!1,this.options=r;var i=e(t),s=i.height(),o="";this.options.autoHeight?s=-1:s=s<0?parseInt(i.attr("rows"))*parseFloat(i.css("line-height")):s,this.options.bkColor&&this.options["bkColor"]!=""&&(o="background-color:"+this.options.bkColor);var u="<style>.btn.gos-btn-sm{padding: 2px 10px;}.gos-editor-container{position:relative;max-width:"+r.maxWidth+"}.gos-editor-container.toolbar-bottom{margin-bottom:20px;}.gos-editor-container.menu-bottom .dropdown ul{border-top-style:solid;border-bottom-style:none;top:auto;bottom:12px;}.gos-editor-container.toolbar-bottom .editor-toolbar{z-index:10;margin-bottom: 3px;position: absolute;bottom: -27px;}.gos-editor-container.fullPage{position: fixed;background-color: #FFFFFF;height: 100%;width: 100%;z-index:90;left: 0;top:0;padding: 20px;}.gos-editor-container.fullPage>.editor-toolbar, .gos-editor-container.fullPage>.editor-parent{margin-left:auto;margin-right:auto;padding-left:30px;padding-right:30px;}.gos-editor-container.fullPage>.editor-parent{height: 100%;padding-bottom: 30px;}.gos-editor{overflow: auto;}.single{margin-right:3px}.dropdown {position: relative;}.dropdown:hover ul {display: block;}.dropdown ul{display: none;list-style-type: none;position:absolute;z-index:2;top:20px;right:-1px;left:-1px;border:1px solid #adadad;border-top-style:none;background:#ebebeb;overflow: hidden;padding:0;}.dropdown li:first-child{margin-top:5px;}.dropdown li a{color:inherit}.gos-placeholder{color:#999999;position:absolute;left:10px;top:8px;display:none}.empty>.gos-placeholder{display:block}.editor-parent{position:relative}.btn-group>a[data-command]:last-child{margin-right:3px;}</style>",a="";this.options.toolbarPosition=="bottom"&&(a=" toolbar-bottom"),this.$editor=e('<div class="gos-editor-container'+a+" "+this.options.class+'">'+u+'<div class="editor-parent clearfix empty"><div tabindex="'+this.options.tabindex+'" class="form-control gos-editor context" contenteditable="true" style="'+(s>0?"height:"+s.toString()+"px:":"height:auto;")+o+'">'+'</div><div class="gos-placeholder"></div></div></div>'),this.$editor.prepend(this.buildToolbar(n));var f=this;return this.$editor.find("div.editor-toolbar").on("click","a[data-command]",function(t){var n=e(this),r=n.data("command-type");switch(r){case"onClick":var i;n.data("drowdown-item")?i=n.closest("div.dropdown").data("option"):i=n.data("option"),i.onClick&&i.onClick.call(this,f.$editor,f);break;default:f.exec(n.data("command"),n.data("command-value"))}}),i.addClass("hidden").after(this.$editor),this.setPlaceholder(i.attr("placeholder")).click(function(t){e(this).prev().focus()}),this.$editor.find("div[contenteditable]").focusin(function(t){e(this).parent().removeClass("empty"),i.trigger("focusin",t)}).focusout(function(t){var n=e(this);n.text()===""?n.parent().addClass("empty"):n.parent().removeClass("empty");var r=n.html();r!=i.html()&&(i.val(r),i.trigger("change",t)),i.trigger("focusout",t)}).keypress(function(e){i.trigger("focusout",e)}),this};return t.prototype.setPlaceholder=function(e){return this.$editor.find("div.gos-placeholder").text(e)},t.prototype.enable=function(){this.$editor.find("div.gos-editor").attr("contenteditable","true"),this.$editor.find("div.editor-toolbar").show()},t.prototype.disable=function(){this.$editor.find("div.gos-editor").attr("contenteditable","false"),this.$editor.find("div.editor-toolbar").hide()},t.prototype.copyToTextArea=function(){var e=this.$editor.find("div[contenteditable]").html();this.isMarkdown?e.substr(0,1)!=""&&(e=""+e):e.substr(0,1)==""&&(e=e.substr(1)),this.$editor.prev().html(e)},t.prototype.setMarkdownMode=function(e){e?this.$editor.find("div.editor-toolbar a[data-command=mode][data-command-value=0]").trigger("click",this.$editor,this):this.$editor.find("div.editor-toolbar a[data-command=mode][data-command-value=1]").trigger("click",this.$editor,this)},t.prototype.val=function(t){if(!t)return this.copyToTextArea(),e(this.target).val();var n=t.charAt(0)=="";this.isMarkdown!=n&&(this.setMarkdownMode(n),this.isMarkdown=n),e(this.target).val(t),this.$editor.find("div[contenteditable]").html(t)},t.prototype.exec=function(t,n){if(e.fn.gosEditor.safeActions.indexOf(t)===-1)return;this.state(t)?document.execCommand(t,!1,null):document.execCommand(t,!1,n)},t.prototype.state=function(e){return document.queryCommandState(e)===!0},t.prototype.buildToolbar=function(t){var n,r,i="",s=e('<div class="editor-toolbar" style="margin-bottom:3px;"></div>'),o;for(n=0;n<t.length;n++)if(e.isArray(t[n])){i=e('<div class="btn-group"></div>');for(r=0;r<t[n].length;r++)i.append(this.buildButton(t[n][r]));s.append(i)}else s.append(this.buildButton(t[n],!0));return s},t.prototype.buildButton=function(t,n){if(!t)return"";var r,i,s=this.options.btnClass,o=t.cmd?' data-command="'+t.cmd+'"':"",u=t.value?' data-command-value="'+String(t.value)+'"':"",a=n?" single":"",f=t["class"]?" "+t["class"]:"",l="command",c;if(this.options.disabledButtons.indexOf(t.cmd)>-1)return null;t.dialog?l="dialog":t.onClick&&(l="onClick");switch(t.type){case"dropdown":r='<div data-group="true" data-command="'+t.cmd+'" class="'+s+f+" dropdown command-active"+a+'"'+(t.value?' data-value="'+t.value+'"':"")+'><span class="content">'+t.content+'</span> <span class="caret"></span><ul>';for(var h=t.dropdown.length-1;h>=0;h--){c=t.dropdown[h],f=c["class"]?' class="'+c["class"]+'" ':"";switch(t.cmd){case"foreColor":r+='<li><a href="#"'+f+' style="display:block;width:auto;height:12px;margin:3px;background-color:'+c.value+';" data-command="'+c.cmd+'" data-command-value="'+c.value+'" data-command-type="'+l+'" data-drowdown-item="true"></a></li>';break;default:r+='<li><a href="#"'+f+' style="margin-bottom:3px;" data-command="'+c.cmd+'" data-command-value="'+c.value+'" data-command-type="'+l+'" data-drowdown-item="true">'+c.content+"</a></li>"}}r+="</ul></div>",i=e(r);break;default:r='<a href="#" class="'+s+a+f+'"'+o+u+' data-command-type="'+l+'">'+t.content+"</a>",i=e(r)}return l!=="command"&&i.data("option",t),i},e.fn.gosEditor=function(n,r){return this.each(function(){r=r||e.fn.gosEditor.defaultButtons();var i={},s;for(s in e.fn.gosEditor.defaultOptions)i[s]=e.fn.gosEditor.defaultOptions[s];n=e.extend(i,n),e(this).data("gos.editor",new t(this,r,n))}),this},e.fn.gosEditor.Constructor=t,e.fn.gosEditor.safeActions=["bold","italic","underline","strikethrough","insertunorderedlist","insertorderedlist","blockquote","pre","foreColor"],e.fn.gosEditor.defaultOptions={btnClass:"btn btn-default gos-btn-sm",toolbarPosition:"top",maxWidth:"none","class":"",tabindex:10,disabledButtons:[],autoHeight:!1},e.fn.gosEditor.defaultButtons=function(){return[{cmd:"mode",value:1,content:"Rich Text",type:"dropdown",dropdown:[{cmd:"mode",value:1,content:"Rich Text","class":"hidden"},{cmd:"mode",value:0,content:"MarkDown "}],onClick:function(t,n){var r=e(this),i=r.closest("div.dropdown"),s=["mode","fullPage","insertImage","createLink"],o=function(n){t.find("a[data-command],div[data-command]").each(function(){$thisSub=e(this);if($thisSub.data("drowdown-item"))return;if(s.indexOf($thisSub.data("command"))>-1)return;n?$thisSub.show():$thisSub.hide()})};parseInt(r.data("command-value"))===1?(i.data("command-value",1),o(!0),n.isMarkdown=!1):(i.data("command-value","0"),o(!1),n.isMarkdown=!0),i.find("span.content").text(r.text()),i.find(".hidden").removeClass("hidden"),r.addClass("hidden")}},[{cmd:"bold",content:'<i class="fa fa-bold"></i>'},{cmd:"italic",content:'<i class="fa fa-italic"></i>'}],[{cmd:"justifyLeft",content:'<i class="fa fa-align-left"></i>'},{cmd:"justifyCenter",content:'<i class="fa fa-align-center"></i>'},{cmd:"justifyRight",content:'<i class="fa fa-align-right"></i>'}],{cmd:"foreColor",content:'<i class="fa fa-font"></i>',type:"dropdown",dropdown:[{cmd:"foreColor",value:"black",content:'<span class="background-color:black">color</span>'},{cmd:"foreColor",value:"silver",content:'<span class="background-color:silver">color</span>'},{cmd:"foreColor",value:"gray",content:'<span class="background-color:gray">color</span>'},{cmd:"foreColor",value:"purple",content:'<span class="background-color:purple">color</span>'},{cmd:"foreColor",value:"fuchsia",content:'<span class="background-color:fuchsia">color</span>'},{cmd:"foreColor",value:"darkOrchid",content:'<span class="background-color:darkOrchid">color</span>'},{cmd:"foreColor",value:"olive",content:'<span class="background-color:olive">color</span>'},{cmd:"foreColor",value:"coral",content:'<span class="background-color:coral">color</span>'},{cmd:"foreColor",value:"maroon",content:'<span class="background-color:maroon">color</span>'},{cmd:"foreColor",value:"crimson",content:'<span class="background-color:crimson">color</span>'},{cmd:"foreColor",value:"navy",content:'<span class="background-color:navy">color</span>'},{cmd:"foreColor",value:"darkGreen",content:'<span class="background-color:darkGreen">color</span>'},{cmd:"foreColor",value:"teal",content:'<span class="background-color:teal">color</span>'},{cmd:"foreColor",value:"dodgerBlue",content:'<span class="background-color:dodgerBlue">color</span>'},{cmd:"foreColor",value:"slateBlue",content:'<span class="background-color:slateBlue">color</span>'},{cmd:"foreColor",value:"steelBlue",content:'<span class="background-color:steelBlue">color</span>'}]},[{cmd:"insertUnorderedList",content:'<i class="fa fa-list"></i>'},{cmd:"insertOrderedList",content:'<i class="fa fa-list-ol"></i>'}],[{cmd:"createLink",content:'<i class="fa fa-link"></i>'},{cmd:"insertImage",content:'<i class="fa fa-picture-o"></i>'}],{cmd:"fullPage",value:1,content:'<i class="fa fa-arrows-alt"></i>',onClick:function(t,n){var r=e(this);if(parseInt(r.data("command-value"))===1)t.addClass("fullPage"),t.removeClass("toolbar-bottom"),r.data("command-value","0"),t.find("div.gos-editor").css("height","100%");else{t.removeClass("fullPage"),n.options.toolbarPosition&&n.options.toolbarPosition=="bottom"&&t.addClass("toolbar-bottom"),r.data("command-value","1");if(n.options.autoHeight)t.find("div.gos-editor").css("height","auto");else{var i=t.prev(),s=i.height();s=s<0?parseInt(i.attr("rows"))*parseFloat(i.css("line-height")):s,t.find("div.gos-editor").css("height",s.toString()+"px")}}}}]},null})(jQuery);